"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{4436:function(e,n,t){var r=t(5893);t(7294);n.Z=function(e){var n=e.title,t=e.subtitle;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{className:"text-gray-700 text-2xl font-medium block mt-16",children:n}),(0,r.jsx)("span",{className:"mt-3 text-sm text-gray-500",children:t})]})}},2369:function(e,n,t){var r=t(5893);t(7294);n.Z=function(e){var n=e.children;return(0,r.jsx)("main",{className:"my-8",children:(0,r.jsx)("div",{className:"container mx-auto px-6",children:n})})}},3193:function(e,n,t){var r=t(5893),i=(t(7294),t(1664));n.Z=function(){return(0,r.jsx)("footer",{className:"bg-gray-200",children:(0,r.jsxs)("div",{className:"container mx-auto px-6 py-3 flex justify-between items-center",children:[(0,r.jsx)("div",{className:"text-xl font-bold text-green-500 hover:text-green-400 cursor-pointer",children:(0,r.jsx)(i.default,{href:"/",children:"MongoFlix"})}),(0,r.jsx)("p",{className:"py-2 text-gray-500 sm:py-0",children:"All rights reserved"})]})})}},2484:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(5893),i=t(7294),s=t(1664),l=t(7804),o=function(e){var n=e.text,t=void 0===n?"":n,i=e.highlight,s=void 0===i?"":i;if(!s.trim()||s.includes("(")||s.includes(")"))return(0,r.jsx)("span",{children:t});var l=new RegExp("(".concat(s,")"),"gi"),o=t.split(l);return(0,r.jsx)("span",{children:o.filter(String).map((function(e,n){return l.test(e)?(0,r.jsx)("mark",{className:"bg-green-400",children:e},n):(0,r.jsx)("span",{children:e},n)}))})},a=function(e,n){var t,r,i=null===e||void 0===e?void 0:e.find((function(e){return e.path===n})),s=null===i||void 0===i||null===(t=i.texts)||void 0===t?void 0:t.find((function(e){return"hit"===e.type}));return null!==(r=null===s||void 0===s?void 0:s.value)&&void 0!==r?r:""},c=function(e){var n,t,c,u=e.movie,d=e.showDetail,f=void 0===d||d,h=a(u.highlights,"title"),x=a(u.highlights,"plot"),m=a(u.highlights,"genres"),v=a(u.highlights,"countries"),p=(0,i.useState)(!1);p[0],p[1];return(0,r.jsx)(s.default,{href:"/movies/".concat(u._id),children:(0,r.jsxs)("div",{className:"bg-white w-full max-w-sm mx-auto rounded-xl shadow-xl overflow-hidden cursor-pointer hover:shadow-2xl transition relative",children:[(0,r.jsxs)("div",{className:"flex items-end justify-end h-80 w-full bg-cover relative",children:[u.poster&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"h-80 w-full relative overflow-hidden",children:[(0,r.jsx)("img",{src:"https://source.unsplash.com/random/1920x1080",alt:"blur bg",className:"absolute min-w-full max-w-full max-h-full blur-md object-contain -z-10 scale-[3]"}),(0,r.jsx)("img",{src:u.poster,alt:u.title,className:"absolute min-w-full max-w-full max-h-full blur-md object-contain -z-10 scale-[3]"})]}),(0,r.jsx)("img",{src:u.poster,alt:u.title,className:"absolute min-w-full max-w-full max-h-full z-10 object-contain"})]}),(0,r.jsx)("button",{className:"absolute z-10 p-2 rounded-full bg-green-600 text-white mx-5 -mb-4 hover:bg-green-500 focus:outline-none focus:bg-green-500",children:(0,r.jsx)(l.o1U,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"px-5 py-3 relative",children:[(0,r.jsx)("h3",{className:"text-gray-800 uppercase text-2xl font-semibold",children:(0,r.jsx)(o,{text:u.title,highlight:h})}),f&&(0,r.jsxs)(r.Fragment,{children:[u.year&&u.genres&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("h4",{className:"text-gray-600 text-sm font-medium",children:[u.year," -",(0,r.jsx)(o,{text:null!==(n=u.genres.join(", "))&&void 0!==n?n:"",highlight:m})]})}),u.countries&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("h4",{className:"text-gray-600 text-sm font-medium",children:(0,r.jsx)(o,{text:null!==(t=u.countries.join(", "))&&void 0!==t?t:"",highlight:v})})}),(0,r.jsx)("h4",{className:"text-gray-600 text-sm mt-2",children:(0,r.jsx)(o,{text:null!==(c=u.plot)&&void 0!==c?c:"",highlight:x})})]})]})]})})}},2276:function(e,n,t){t.r(n),t.d(n,{default:function(){return q},handleError:function(){return A}});var r=t(4051),i=t.n(r),s=t(5893),l=t(9008),o=t(7294),a=t(4436),c=t(2369),u=t(3193),d=t(1664),f=t(1163),h=t(7804),x=t(3815),m=t(8100),v=t(8687),p=function(e){var n=e.list,t=e.selectedList,r=e.addItem,i=e.removeItem;return(0,s.jsx)("div",{id:"dropdown",className:"absolute shadow top-100 bg-white z-40 w-full lef-0 rounded max-h-select overflow-y-auto ",children:(0,s.jsx)("div",{className:"flex flex-col w-full",children:n.map((function(e,n){return t.includes(e.title)?(0,s.jsx)("div",{className:"cursor-pointer w-full border-gray-100 rounded-t border-b hover:bg-teal-100",onClick:function(){return i(e.title)},children:(0,s.jsx)("div",{className:"flex w-full items-center p-2 pl-2 border-transparent border-l-2 relative bg-green-300",children:(0,s.jsx)("div",{className:"w-full items-center flex",children:(0,s.jsxs)("div",{className:"mx-2 leading-6 ",children:[e.title," ",(0,s.jsx)("span",{className:"text-gray-700 text-sm font-light",children:e.subtitle})]})})})},n):(0,s.jsx)("div",{className:"cursor-pointer w-full border-gray-100 rounded-t border-b hover:bg-teal-100",onClick:function(){return r(e.title)},children:(0,s.jsx)("div",{className:"flex w-full items-center p-2 pl-2 border-transparent border-l-2 relative hover:bg-green-100",children:(0,s.jsx)("div",{className:"w-full items-center flex",children:(0,s.jsxs)("div",{className:"mx-2 leading-6 ",children:[e.title," ",(0,s.jsx)("span",{className:"text-gray-700 text-sm font-light",children:e.subtitle})]})})})},n)}))})})},g=function(e){var n=e.items,t=e.selectedItems,r=e.setSelectedItems,i=e.placeholder,l=(0,o.useState)(!1),a=l[0],c=l[1],u=function(e){var n=t.filter((function(n){return n!==e}));r(n)};return(0,s.jsx)("div",{className:"autcomplete-wrapper",children:(0,s.jsx)("div",{className:"autcomplete relative my-3 max-w-lg mx-auto",children:(0,s.jsx)("div",{className:"w-full flex flex-col items-center mx-auto",children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"flex flex-col items-center relative",children:(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"p-1 flex border border-gray-200 bg-white rounded focus-within:border-green-500 focus-within:outline-none focus-within: :shadow-outline",children:[(0,s.jsxs)("div",{className:"flex flex-auto flex-wrap",children:[t.map((function(e,n){return(0,s.jsxs)("div",{className:"flex justify-center items-center m-1 font-medium py-1 px-2 bg-white rounded-full text-teal-700 bg-teal-100 border border-teal-300 ",children:[(0,s.jsx)("div",{className:"text-xs font-normal leading-none max-w-full flex-initial",children:e}),(0,s.jsx)("div",{className:"flex flex-auto flex-row-reverse",children:(0,s.jsx)("div",{onClick:function(){return u(e)},children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-x cursor-pointer hover:text-teal-400 rounded-full w-4 h-4 ml-2",children:[(0,s.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,s.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})})]},n)})),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("input",{placeholder:i,className:"bg-transparent p-1 px-2 appearance-none outline-none h-full w-full text-gray-800"})})]}),(0,s.jsx)("div",{className:"text-gray-300 w-8 py-1 pl-2 pr-1 border-l flex items-center border-gray-200",onClick:function(){c(!a)},children:(0,s.jsx)("button",{className:"cursor-pointer w-6 h-6 text-gray-600 outline-none focus:outline-none",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-chevron-up w-4 h-4",children:(0,s.jsx)("polyline",{points:"18 15 12 9 6 15"})})})})]})})}),a?(0,s.jsx)(p,{list:n,selectedList:t,addItem:function(e){r(t.concat(e)),c(!1)},removeItem:u}):null]})})})})};function j(e,n,t,r,i,s,l){try{var o=e[s](l),a=o.value}catch(error){return void t(error)}o.done?n(a):Promise.resolve(a).then(r,i)}function w(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function b(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){w(e,n,t[n])}))}return e}var y=function(){var e,n=(e=i().mark((function e(n,t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.bm)();case 2:return r=e.sent,e.abrupt("return",(0,v.request)(x.wj,n,{title:t},r));case 4:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var s=e.apply(n,t);function l(e){j(s,r,i,l,o,"next",e)}function o(e){j(s,r,i,l,o,"throw",e)}l(void 0)}))});return function(e,t){return n.apply(this,arguments)}}(),N=function(e){var n,t=e.genresWithCount,r=e.countries,i=e.filters,l=e.setFilters,a=(0,f.useRouter)(),c=(0,o.useState)(!0),u=c[0],x=c[1],v=(0,o.useState)(""),p=v[0],j=v[1],w=(0,o.useState)(0),N=w[0],_=w[1],k=(0,m.ZP)(["\n    query GetAutocompleteTitle($title: String!) {\n        autocompleteTitle(input: $title) {\n            _id\n            title\n            poster\n        }\n    }\n",p],y).data;if(null===k||void 0===k?void 0:k.error)return A(k.error);var I=null!==(n=null===k||void 0===k?void 0:k.autocompleteTitle)&&void 0!==n?n:[],S=function(e){j(""),a.push({pathname:"/movies/".concat(e)})},C=function(e){"ArrowUp"===e.key&&(e.preventDefault(),_((N-1+I.length)%I.length),console.log(N)),"ArrowDown"===e.key&&(e.preventDefault(),_((N+1)%I.length),console.log(N))};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("header",{children:(0,s.jsxs)("div",{className:"container mx-auto px-6 py-3",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)(d.default,{href:"/",children:(0,s.jsx)("div",{className:"w-full text-green-500 text-2xl font-semibold cursor-pointer",children:"MongoFlix"})})}),(0,s.jsxs)("div",{className:"relative mt-6 max-w-lg mx-auto",children:[(0,s.jsx)("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center",children:(0,s.jsx)(h.W1M,{className:"h-5 w-5"})}),(0,s.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),x(!1),I.length>0&&N<I.length){var n=I[N]._id;S(n)}},children:(0,s.jsx)("input",{className:"w-full border rounded-md pl-10 pr-4 py-2 focus:border-green-500 focus:outline-none focus:shadow-outline",type:"text",placeholder:"Search",onChange:function(e){return n=e.target.value,x(!0),j(n),void l(b({},i,{term:n}));var n},onBlur:function(){return x(!1)},onFocus:function(){return x(!0)},value:p,onKeyDown:C})}),I.length>0&&u&&(0,s.jsx)("ul",{className:"absolute inset-x-0 top-full bg-white border border-green-500 rounded-md z-20",tabIndex:0,onKeyDown:C,children:I.map((function(e,n){return(0,s.jsx)("li",{className:"px-4 py-2\n                                            ".concat(N===n?"bg-green-300":""," hover:bg-green-300 cursor-pointer"),onMouseDown:function(e){return e.preventDefault()},onClick:function(){return S(e._id)},children:e.title},e._id)}))})]}),(0,s.jsx)(g,{items:t.map((function(e){return{title:e._id,subtitle:e.count}})),selectedItems:i.genres,setSelectedItems:function(e){l(b({},i,{genres:e}))},placeholder:"Select Genres"}),(0,s.jsx)(g,{items:r.map((function(e){return{title:e._id,subtitle:e.count}})),selectedItems:i.countries,setSelectedItems:function(e){l(b({},i,{countries:e}))},placeholder:"Select Countries"})]})})})},_=t(2484),k=function(e){var n=e.movies;return(0,s.jsx)("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 mt-6",children:n.map((function(e){return(0,s.jsx)(_.Z,{movie:e},e._id)}))})},I=[{_id:"Drama",count:""},{_id:"Comedy",count:""},{_id:"Romance",count:""},{_id:"Crime",count:""},{_id:"Thriller",count:""},{_id:"Action",count:""},{_id:"Documentary",count:""},{_id:"Adventure",count:""},{_id:"Horror",count:""},{_id:"Biography",count:""}],S=[{_id:"Australia"},{_id:"Austria"},{_id:"Belgium"},{_id:"China"},{_id:"Denmark"},{_id:"Finland"},{_id:"France"},{_id:"Germany"},{_id:"Hong Kong"},{_id:"Israel"},{_id:"Italy"},{_id:"Japan"},{_id:"Mexico"},{_id:"New Zealand"},{_id:"Norway"},{_id:"Poland"},{_id:"Romania"},{_id:"Russia"},{_id:"Spain"},{_id:"Sweden"},{_id:"Switzerland"},{_id:"Taiwan"},{_id:"UK"},{_id:"USA"}];function C(e,n,t,r,i,s,l){try{var o=e[s](l),a=o.value}catch(error){return void t(error)}o.done?n(a):Promise.resolve(a).then(r,i)}function F(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var s=e.apply(n,t);function l(e){C(s,r,i,l,o,"next",e)}function o(e){C(s,r,i,l,o,"throw",e)}l(void 0)}))}}var M=function(){var e=F(i().mark((function e(n,t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.bm)();case 2:return r=e.sent,e.abrupt("return",(0,v.request)(x.wj,n,{sortByInput:"METACRITIC_DESC",queryInput:{poster_exists:!0,genres_in:t.genres.length>0?t.genres:void 0,countries_in:t.countries.length>0?t.countries:void 0},limit:50},r));case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),P=function(){var e=F(i().mark((function e(n,t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.bm)();case 2:return r=e.sent,e.abrupt("return",(0,v.request)(x.wj,n,{filter:t},r));case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),D=function(){var e=F(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,x.bm)();case 2:return t=e.sent,e.abrupt("return",(0,v.request)(x.wj,n,null,t));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),A=function(e){return console.error(e),(0,s.jsxs)("p",{children:["An error occurred: $",e]})};function q(){var e,n,t=(0,o.useState)({term:"",genres:[],countries:[]}),r=t[0],i=t[1],d=(0,m.ZP)(["\n    query GetFilteredMovies($filter: FilteredMoviesInput!) {\n        filteredMovies(input: $filter) {\n            _id\n            title\n            poster\n            cast\n            directors\n            plot\n            fullplot\n            year\n            score\n            genres\n            countries\n            highlights {\n                path\n                score\n                texts {\n                    value\n                    type\n                }\n            }\n        }\n    }\n",r],P).data;if(null===d||void 0===d?void 0:d.error)return A(error);var f,h=null!==(n=null===d||void 0===d?void 0:d.filteredMovies)&&void 0!==n?n:[],x=(0,m.ZP)(["\n    query GetMovies($sortByInput: MovieSortByInput!, $queryInput: MovieQueryInput!, $limit: Int!) {\n        movies(sortBy: $sortByInput, query: $queryInput, limit: $limit) {\n            _id\n            title\n            poster\n            genres\n            countries\n            cast\n            directors\n            plot\n            fullplot\n            year\n        }\n    }\n",r],M).data;if(null===x||void 0===x?void 0:x.error)return A(x.error);var v,p=null!==(f=null===x||void 0===x?void 0:x.movies)&&void 0!==f?f:[],g=(0,m.ZP)(["\n    query GetFacetsGenres {\n        facetsGenres {\n            count\n            facet {\n                genresFacet {\n                    buckets {\n                        _id\n                        count\n                    }\n                }\n            }\n        }\n    }\n"],D).data;if(null===g||void 0===g?void 0:g.error)return A(g.error);var j=null!==(v=null===(e=null===g||void 0===g?void 0:g.facetsGenres[0])||void 0===e?void 0:e.facet.genresFacet.buckets)&&void 0!==v?v:I,w=S;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen",children:[(0,s.jsxs)(l.default,{children:[(0,s.jsx)("title",{children:"MongoFlix"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)("div",{className:"bg-gray-100 w-full min-h-screen",children:[(0,s.jsx)(N,{genresWithCount:j,countries:w,filters:r,setFilters:i}),(0,s.jsxs)(c.Z,{children:[(0,s.jsx)(a.Z,{title:"Movie Search",subtitle:"".concat(h.length>0?h.length:p.length," Movies")}),(0,s.jsx)(k,{movies:h.length>0?h:p})]}),(0,s.jsx)(u.Z,{})]})]})}},3815:function(e,n,t){t.d(n,{wj:function(){return d},bm:function(){return h}});var r=t(4051),i=t.n(r),s=t(9566);function l(e,n,t,r,i,s,l){try{var o=e[s](l),a=o.value}catch(error){return void t(error)}o.done?n(a):Promise.resolve(a).then(r,i)}function o(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var s=e.apply(n,t);function o(e){l(s,r,i,o,a,"next",e)}function a(e){l(s,r,i,o,a,"throw",e)}o(void 0)}))}}var a,c="application-0-kjasg",u=null!==(a=t(3454).env.NEXT_PUBLIC_REALM_BASE_URL)&&void 0!==a?a:"eu-central-1.aws.realm.mongodb.com",d="https://".concat(u,"/api/client/v2.0/app/").concat(c,"/graphql"),f=new s.gV({id:c,baseUrl:"https://".concat(u)}),h=function(){var e=o(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f.currentUser){e.next=5;break}return e.next=3,f.logIn(s.cN.anonymous());case 3:e.next=7;break;case 5:return e.next=7,f.currentUser.refreshCustomData();case 7:return n=f.currentUser.accessToken,e.abrupt("return",{Authorization:"Bearer ".concat(n)});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();!function(){var e=o(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.cN.anonymous(),e.prev=1,e.next=4,f.logIn(n);case 4:return t=e.sent,e.next=7,t.functions.nameOfRealmFunction();case 7:e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))}()}}]);